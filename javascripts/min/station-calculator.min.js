var MARGIN_INDEX=4;function beginStation(a){station_buy=a;getRowsStation()}function getRowsStation(){$("#selection").hide();var a;for(a=0;a<itemIds.length&&a<JUMPS;a++){var b=itemIds[a];getBuyStationPrice(b,false);length=itemIds[a]}if(a>=itemIds.length){$("#stop").val("Finished");$("#stop").prop("disabled",true);itemIds=[]}itemIds=itemIds.splice(JUMPS,itemIds.length)}function getSingleData(c,b,a,d){if(typeof(c)=="string"){return c}else{if(c!=null){return getBestSinglePrice(c,b,a,d)}}}function getBuyStationPrice(e,d){var b=ENDPOINT+"/market/"+station_buy[0]+"/orders/buy/";var c="?type="+ENDPOINT+"/types/"+e+"/";try{$.ajax({type:"get",url:b+c,success:function(g){var f=getSingleData(g,station_buy[1],"buy",e);if(f!=-1){var h=g.items[0].type.name;getSellStationPrice(e,f,h,d)}else{if(e===length){window.setTimeout(goAgain(),SECOND_DELAY)}}},error:function(g,f){unreachable()}})}catch(a){getBuyStationPrice(e,d)}}function getSellStationPrice(g,b,e,d){var f=ENDPOINT+"/market/"+station_buy[0]+"/orders/sell/";var c="?type="+ENDPOINT+"/types/"+g+"/";try{$.ajax({type:"get",url:f+c,success:function(i){var h=getSingleData(i,station_buy[1],"sell",g);if(h!=-1){addMarginRow(g,e,h,b)}else{if(g===length){window.setTimeout(goAgain(),SECOND_DELAY)}}},error:function(i,h){unreachable()}})}catch(a){getSellStationPrice(g,b,e,d)}}function addMarginRow(g,i,e,b){var a=e-b;var c=(e-b)/e;if(c*100>=threshold_lower&&c*100<=threshold_upper){if(!created){created=true;dt=$("#dataTable").DataTable({order:[[MARGIN_INDEX,"desc"]],lengthMenu:[[-1],["All"]]});var h=0;$("#dataTable thead th").each(function(m){var k=dt.column(m).header();var o=document.createElement("button");var l=[];if($(document).width()<768){l=["Profit Per Item"]}o.innerHTML=k.innerHTML;$(o).addClass("colvistoggle");$(o).addClass("btn");$(o).addClass("btn-default");$(o).attr("colidx",m);$(o).addClass("is-true");var n=dt.column($(o).attr("colidx"));n.visible(true);for(var m=0;m<l.length;m++){if(o.innerHTML===l[m]){$(o).addClass("is-false");var n=dt.column($(o).attr("colidx"));n.visible(false);break}}$(o).on("click",function(q){q.preventDefault();var p=dt.column($(this).attr("colidx"));$(this).removeClass("is-"+p.visible());p.visible(!p.visible());$(this).addClass("is-"+p.visible())});var j=document.createElement("li");$(j).append($(o));$("#colvis").append($(j))});$("#show-hide").show();$(".dropdown").on("show.bs.dropdown",function(j){$(this).find(".dropdown-menu").first().stop(true,true).slideDown()});$(".dropdown").on("hide.bs.dropdown",function(j){$(this).find(".dropdown-menu").first().stop(true,true).slideUp()});$("#dataTable tbody").on("mousedown","tr",function(j){if(j.which===1){if(!$(this).hasClass("row-selected")){$(this).addClass("row-selected")}else{$(this).removeClass("row-selected")}}});$("label > input").addClass("form-control").addClass("minor-text");$("label > input").attr("placeholder","Search Results...");$(".loading").hide();$("#dataTable").show()}var d=[i,numberWithCommas(b.toFixed(2)),numberWithCommas(e.toFixed(2)),numberWithCommas(a.toFixed(2)),(c.toFixed(3)*100).toFixed(1)+"%"];var f=$("#dataTable").dataTable().fnAddData(d)}if(g===length){window.setTimeout(goAgain(),SECOND_DELAY)}}function getBestSinglePrice(b,f,c,h){var g=-1;var e=b.items;for(var d=0;d<e.length;d++){var a=e[d];if(f==a.location["id"]){if(g==-1){g=a.price}else{if(c=="sell"){if(g>a.price){g=a.price}}else{if(g<a.price){g=a.price}}}}}return g};