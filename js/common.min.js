var BUY_ORDER="buy";var SELL_ORDER="sell";var ALL_ORDER="all";var ESI_ENDPOINT="https://esi.evetech.net";var PAGE_MULTIPLE=50;var tableCreated=false;var createdRefresher=false;var totalProgress=0;var executingCount=0;var customBuy={};var customSell={};var itemCache={};var page=1;var iteration=1;var rowAdded=false;var regionHeader=["","Buy Item","From","Quantity","At Sell Price","Total Cost","Take To","At Buy Price","Total Profit","Profit Per Item","R.O.I","Total Volume (m3)"];var routeHeader=["","Buy Item","From","Quantity","At Sell Price","Total Cost","Take To","At Buy Price","Total Profit","Profit Per Item","R.O.I","Total Volume (m3)"];var stationHeader=["Item","Buy Order","Sell Order","Profit Per Item","Margin","Volume"];var spamItems=["ahremen's","brokara's","brynn's","chelm's","cormack's","draclira's","estamel's","gotan's","hakim's","kaikka's","mizuro's","raysere's","selynne's","setele's","shaqil's","tairei's","thon's","tuvan's","vizen's","zor's"];function getMarketData(f,e,a,h,d){var g;if(typeof(f)=="string"){g=[f]}else{if(f!=null){g=getBestMarketPrice(f,e,a,h,d)}}var b=[];if(g){for(var c=0;c<g.length;c++){if(g[c][0]>0){b.push(g[c])}}}return b}function getBestMarketPrice(e,d,k,i,j){var h=[];for(var l=0;l<e.length;l++){var c=e[l];var b=(c.is_buy_order&&k===BUY_ORDER)||(!c.is_buy_order&&k===SELL_ORDER);if(d==c.location_id&&c.min_volume===1&&b){var g=c.price;var f=c.volume_remain;h.push([g,f])}}if(k==SELL_ORDER){var a=j?sellOrderComparator:buyOrderComparator;h=h.sort(a);saveSellOrderData(d,i,$.extend(true,[],h))}else{var a=j?buyOrderComparator:sellOrderComparator;h=h.sort(a);saveBuyOrderData(d,i,$.extend(true,[],h))}return h}function saveSellOrderData(b,c,a){if(a&&a.length>0){if(!customBuy[b]){customBuy[b]=[]}if(!customBuy[b][c]&&a.length>0){customBuy[b][c]=a}}}function saveBuyOrderData(b,c,a){if(a&&a.length>0){if(!customSell[b]){customSell[b]=[]}if(!customSell[b][c]&&a.length>0){customSell[b][c]=a}}}function sellOrderComparator(d,c){if(d[0]>c[0]){return -1}if(d[0]<c[0]){return 1}return 0}function buyOrderComparator(d,c){if(d[0]>c[0]){return 1}if(d[0]<c[0]){return -1}return 0}function bestRowComparator(d,c){if(d[5]<c[5]){return 1}if(d[5]>c[5]){return -1}return 0}function getStationName(b){var a="";$.each(endCoordinates,function(){if(a.length==0&&this.station==b){a=this.name}});return a}function numberWithCommas(a){while(/(\d+)(\d{3})/.test(a.toString())){a=a.toString().replace(/(\d+)(\d{3})/,"$1,$2")}return a}function incrementProgress(b,a){getTotalProgress();b.completePages[a]=true}function getTotalProgress(){var a=0;var d=true;for(var b=0;b<routes.length;b++){d=(d&&routes[b].completed);var c=routes[b].recalculateProgress();a+=c/routes.length}if(d){totalProgress=100}else{totalProgress=a>100?100:a}$(".loading").html("Fetching orders: "+(totalProgress-0.01).toFixed(2)+"% complete");$(".loadingContent").text((totalProgress-0.01).toFixed(2)+"%")}function refresh(){$("#refresh-button").remove();iteration+=1;for(var a=0;a<routes.length;a++){routes[a].clear()}customBuy=[];customSell=[];startCoordinates=[];endCoordinates=[];startLocation="";addedToStartList=[];addedToEndList=[];endLocations=[];page=1;totalProgress=0;createdRefresher=false;tableCreated=false;routes=[];init()}function isSpamItem(a){for(var b=0;b<spamItems.length;b++){if(a.toLowerCase().indexOf(spamItems[b])>=0){return true}}return false}function marketEndpointBuilder(d,c,a){var b=ESI_ENDPOINT+"/latest/markets/"+d+"/orders/?datasource=tranquility&page="+c+"&order_type="+a+"&language=en-us&iteration="+iteration;return b.replace(/\s/g,"")}function getWeightEndpointBuilder(b){var a=ESI_ENDPOINT+"/latest/universe/types/"+b+"/?datasource=tranquility&language=en-us&iteration="+iteration;return a.replace(/\s/g,"")}function getVolumeEndpointBuilder(b,c){var a=ESI_ENDPOINT+"/latest/markets/"+b+"/history/?datasource=tranquility&type_id="+c+"&language=en-us&iteration="+iteration;return a.replace(/\s/g,"")}function createTradeHeader(){var a="";var g="";var c="";var f=$("#buyingHeader");var e=$("#buyingFooter");var d=$("#core");if(tradingStyle==1){$.each(startLocations,function(){if(this){g+=this+", "}});g=g.substring(0,g.length-2);$.each(endLocations,function(){if(this){c+=this+", "}});c=c.substring(0,c.length-2)}else{if(tradingStyle==2){g=startLocations;c=endLocations}}if(tradingStyle>=1){f.text("Buying Sell Orders from "+g);var b="<div id='route-to'>Selling to the Buy Orders at "+c+"</div> ROI&nbsp;Greater&nbsp;Than&nbsp;"+threshold_roi+"% |&nbsp;Profits&nbsp;Greater&nbsp;Than&nbsp;"+numberWithCommas(threshold_profit)+"&nbsp;ISK";if(threshold_cost!==1000000000000000000){b+=" |&nbsp;Buy&nbsp;Costs&nbsp;Less&nbsp;Than&nbsp;"+numberWithCommas(threshold_cost)+"&nbsp;ISK"}if(threshold_weight!==1000000000000000000){b+=" |&nbsp;Total&nbsp;Volume&nbsp;Under&nbsp;"+numberWithCommas(threshold_weight)+"&nbsp;m3"}f.show();a=b+"<br/><div class='loading'></div>";e.html(a);e.show()}else{f.text("Station Trading at "+startLocations);f.show();a="Volume greater than: "+numberWithCommas(volume_threshold)+" | Margins between "+threshold_margin_lower+"% and "+threshold_margin_upper+"%<div class='loading'>Loading. Please wait...</div>";e.html(a);e.show()}d.show()}function createDataTable(){if(!tableCreated){tableCreated=true;$("#noselect-object").html('<table id="dataTable" class="display"></table>');$(".dataTableFilters").html("");var d=$("#dataTable");d.html("");var a="<thead>";var e=tradingStyle===0?stationHeader:tradingStyle===1?routeHeader:regionHeader;for(var b=0;b<e.length;b++){a+=("<th>"+e[b]+"</th>")}a+="</thead><tbody id='tableBody'></tbody>";d.append(a);var c;if(tradingStyle>=1){c=d.DataTable({order:[[8,"desc"]],lengthMenu:[[50],["50"]],responsive:true,dom:"Bfrtip",buttons:["copy","csv","excel","pdf"],columnDefs:[{targets:0,orderable:false}]})}else{c=d.DataTable({order:[[5,"desc"]],lengthMenu:[[50],["50"]],responsive:true,dom:"Bfrtip",buttons:["copy","csv","excel","pdf"]})}$("#dataTable thead th").each(function(j){if(j>0||tradingStyle==0){var g=c.column(j).header();var l=document.createElement("button");var h=[];l.innerHTML=g.innerHTML;$(l).addClass("colvistoggle");$(l).addClass("btn");$(l).addClass("btn-default");$(l).attr("colidx",j);$(l).addClass("is-true");var k=c.column($(l).attr("colidx"));k.visible(true);for(var j=0;j<h.length;j++){if(l.innerHTML===h[j]){$(l).addClass("is-false");var k=c.column($(l).attr("colidx"));k.visible(false);break}}$(l).on("click",function(m){m.preventDefault();var i=c.column($(this).attr("colidx"));$(this).removeClass("is-"+i.visible());i.visible(!i.visible());$(this).addClass("is-"+i.visible())});var f=document.createElement("li");$(f).append($(l));$("#colvis").append($(f))}});$(".dropdown").on("show.bs.dropdown",function(f){$(this).find(".dropdown-menu").first().stop(true,true).slideDown()});$(".dropdown").on("hide.bs.dropdown",function(f){$(this).find(".dropdown-menu").first().stop(true,true).slideUp()});$("#dataTable tbody").on("mousedown","tr",function(g){var f=(g.target.id.indexOf("investigate")>=0||(g.target.children[0]&&g.target.children[0].id.indexOf("investigate")>=0)||(g.target.classList.contains("fa")));if(g.which===1&&!f){if(!$(this).hasClass("row-selected")){$(this).addClass("row-selected")}else{$(this).removeClass("row-selected")}}});$("label > input").addClass("form-control").addClass("minor-text");$("label > input").attr("placeholder","Filter by Station/Name...");$(".dataTableFilters").append($("#dataTable_filter"));$(".dataTableFilters").append($(".dt-buttons"));$(".dt-button").addClass("btn");$(".dt-button").addClass("btn-default");$(".deal_note").hide();$("#show-hide").show();$("#dataTable").show();$(".dataTables_paginate").on("click",function(){$(this)[0].scrollIntoView()})}};