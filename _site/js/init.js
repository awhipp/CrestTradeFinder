function getTradeHubName(t){return"Jita IV - Moon 4 - Caldari Navy Assembly Plant"==t?"Jita":"Amarr VIII (Oris) - Emperor Family Academy"==t?"Amarr":"Rens VI - Moon 8 - Brutor Tribe Treasury"==t?"Rens":"Dodixie IX - Moon 20 - Federation Navy Assembly Plant"==t?"Dodixie":"Hek VIII - Moon 12 - Boundless Creation Factory"==t?"Hek":t}function initCompletely(t,e){var o=completely(document.getElementById(t),{fontSize:"18px",fontFamily:"Roboto",color:"#333",ignoreCase:!0});o.options=e,o.repaint(),"start_station"==t&&$($("#"+t+" input")[1]).on("keydown",function(t){13==t.keyCode&&(shifted?newStartStation(t={shiftKey:!0}):newStartStation())}),"end_station"==t&&$($("#"+t+" input")[1]).on("keydown",function(t){13==t.keyCode&&(shifted?newEndStation(t={shiftKey:!0}):newEndStation())})}function setupCustomDropdown(){var a=setInterval(function(){if(station_ids!==undefined){clearInterval(a);for(var t=[""],e=0;e<station_ids.length;e++){var o=station_ids[e][2],n=getTradeHubName(o);if(o!==n){var i=n.toLowerCase();universeList[i]={},universeList[i].region=station_ids[e][1],universeList[i].station=station_ids[e][0],universeList[i].name=n,t.push(n)}i=o.toLowerCase();universeList[i]={},universeList[i].region=station_ids[e][1],universeList[i].station=station_ids[e][0],universeList[i].name=o,t.push(o),stationIdToName[station_ids[e][0]]=o}t.sort(),initCompletely("custom_station",t),initCompletely("start_station",t),initCompletely("end_station",t),stationsReady=!0}},1e3),i=setInterval(function(){if(region_ids!==undefined){clearInterval(i);for(var t=[""],e=0;e<region_ids.length;e++){var o=region_ids[e][1],n=o.toLowerCase();universeList[n]={},universeList[n].name=region_ids[e][1],universeList[n].id=region_ids[e][0],t.push(o)}t.sort(),initCompletely("start_region",t),initCompletely("end_region",t),regionsReady=!0}},1e3),t=setInterval(function(){stationsReady&&regionsReady&&(clearInterval(t),$(function(){var t=1;$("input").each(function(){"hidden"!=this.type&&($(this).attr("tabindex",t),t++)})}),$(".location-input").keyup(function(t){if("9"==t.keyCode){var e=parseInt(t.target.id.charAt(t.target.id.length-1));1==e?$("#volume-threshold").focus():2==e||4==e?$("#location-input-"+(e+1)).focus():3==e?$("#profit-threshold").focus():5==e&&$("#region-profit-threshold").focus()}}),$(".loadingIcon").remove(),$(".core-section").css("opacity",1))},1e3)}function findAllStations(t){var e=[],o=t.toLowerCase();if(-1<t.indexOf(" ")&&(o=t.substr(0,t.indexOf(" ")).toLowerCase()),3<=o.length)for(station in universeList)universeList.hasOwnProperty(station)&&station&&station.startsWith(o)&&-1<station.indexOf(" ")&&e.push(station);return e}function newStartStation(t){var e=document.createElement("li"),o=$("#start_station input")[0].value&&universeList[$("#start_station input")[0].value.toLowerCase()]&&universeList[$("#start_station input")[0].value.toLowerCase()].name;0==o.length&&(o=$("#start_station input")[1].value&&universeList[$("#start_station input")[1].value.toLowerCase()]&&universeList[$("#start_station input")[1].value.toLowerCase()].name);var n=[];if(t&&t.shiftKey){n=findAllStations(o);for(var i=0;i<n.length;i++)$("#start_station input")[0].value=n[i],$("#start_station input")[1].value=n[i],newStartStation(),$("#start_station input")[0].value="",$("#start_station input")[1].value=""}else{var a=document.createTextNode(o);if(-1==addedToStartList.indexOf(o)){addedToStartList.push(o),e.appendChild(a),""===o?alert("You must choose a station!"):(document.getElementById("custom_route_start").style.display="block",document.getElementById("custom_route_start").appendChild(e)),$("#start_station input")[0].value="",$("#start_station input")[1].value="";var s=document.createElement("SPAN"),r=document.createTextNode(" \xd7");s.className="closeStation",s.title="Remove: "+o,s.appendChild(r),e.appendChild(s)}var l=document.getElementsByClassName("closeStation");for(i=0;i<l.length;i++)l[i].onclick=function(){var t=$(this)[0].previousSibling.data;addedToStartList[addedToStartList.indexOf(t)]="",$(this.parentElement).remove()}}}function newEndStation(t){var e=document.createElement("li"),o=$("#end_station input")[0].value&&universeList[$("#end_station input")[0].value.toLowerCase()]&&universeList[$("#end_station input")[0].value.toLowerCase()].name;0==o.length&&(o=$("#end_station input")[1].value&&universeList[$("#end_station input")[1].value.toLowerCase()]&&universeList[$("#end_station input")[1].value.toLowerCase()].name);var n=[];if(t&&t.shiftKey){n=findAllStations(o);for(var i=0;i<n.length;i++)$("#end_station input")[0].value=n[i],$("#end_station input")[1].value=n[i],newEndStation(),$("#end_station input")[0].value="",$("#end_station input")[1].value=""}else{var a=document.createTextNode(o);if(-1==addedToEndList.indexOf(o)){addedToEndList.push(o),e.appendChild(a),""===o?alert("You must choose a station!"):(document.getElementById("custom_route_end").style.display="block",document.getElementById("custom_route_end").appendChild(e)),$("#end_station input")[0].value="",$("#end_station input")[1].value="";var s=document.createElement("SPAN"),r=document.createTextNode(" \xd7");s.className="closeStation",s.title="Remove: "+o,s.appendChild(r),e.appendChild(s)}var l=document.getElementsByClassName("closeStation");for(i=0;i<l.length;i++)l[i].onclick=function(){var t=$(this)[0].previousSibling.data;addedToEndList[addedToEndList.indexOf(t)]="",$(this.parentElement).remove()}}}function onClickListeners(){$(".end").on("click",function(){$(this).hasClass("end-selected")?$(this).removeClass("end-selected"):$(this).addClass("end-selected")}),$(".hauling-region-trader").on("click",function(){setupTradeOptions(2)}),$(".hauling-station-trader").on("click",function(){setupTradeOptions(1)}),$(".station-trader").on("click",function(){setupTradeOptions(0)}),$(".station-start").on("click",function(){$(".station-start").removeClass("station-selected"),$(this).addClass("station-selected")})}function setAbout(){null==tradingStyle?$("#about")[0].onclick=function(){$("#howto").modal("show")}:1<=tradingStyle?$("#about")[0].onclick=function(){$("#howto-route").modal("show")}:0==tradingStyle?$("#about")[0].onclick=function(){$("#howto-station").modal("show")}:2==tradingStyle&&($("#about")[0].onclick=function(){$("#howto-route").modal("show")})}function setupCookies(){$("#lower-margin-threshold").val(getCookie("lower-margin-threshold")),$("#upper-margin-threshold").val(getCookie("upper-margin-threshold")),$("#volume-threshold").val(getCookie("volume-threshold")),$("#profit-threshold").val(getCookie("profit-threshold")),$("#roi-threshold").val(getCookie("roi-threshold")),$("#buy-threshold").val(getCookie("buy-threshold")),$("#weight-threshold").val(getCookie("weight-threshold")),$("#region-profit-threshold").val(getCookie("profit-threshold")),$("#region-roi-threshold").val(getCookie("roi-threshold")),$("#region-buy-threshold").val(getCookie("buy-threshold")),$("#region-weight-threshold").val(getCookie("weight-threshold"))}function updateCookies(){1==tradingStyle?(0<$("#profit-threshold").val().length&&!isNaN($("#profit-threshold").val())?setCookie("profit-threshold",threshold_profit=parseFloat($("#profit-threshold").val()),7):setCookie("profit-threshold",""),0<$("#roi-threshold").val().length&&!isNaN($("#roi-threshold").val())?setCookie("roi-threshold",threshold_roi=parseFloat($("#roi-threshold").val()),7):setCookie("roi-threshold",""),0<$("#buy-threshold").val().length&&!isNaN($("#buy-threshold").val())?setCookie("buy-threshold",threshold_cost=parseFloat($("#buy-threshold").val()),7):setCookie("buy-threshold",""),0<$("#weight-threshold").val().length&&!isNaN($("#weight-threshold").val())?setCookie("weight-threshold",threshold_weight=parseFloat($("#weight-threshold").val()),7):setCookie("weight-threshold","")):0==tradingStyle?(0<$("#lower-margin-threshold").val().length&&!isNaN($("#lower-margin-threshold").val())?setCookie("lower-margin-threshold",threshold_margin_lower=parseFloat($("#lower-margin-threshold").val()),7):setCookie("lower-margin-threshold",""),0<$("#upper-margin-threshold").val().length&&!isNaN($("#upper-margin-threshold").val())?setCookie("upper-margin-threshold",threshold_margin_upper=parseFloat($("#upper-margin-threshold").val()),7):setCookie("upper-margin-threshold",""),0<$("#volume-threshold").val().length&&!isNaN($("#volume-threshold").val())?setCookie("volume-threshold",volume_threshold=parseFloat($("#volume-threshold").val()),7):setCookie("volume-threshold","")):2==tradingStyle&&(0<$("#region-profit-threshold").val().length&&!isNaN($("#region-profit-threshold").val())?setCookie("profit-threshold",threshold_profit=parseFloat($("#region-profit-threshold").val()),7):setCookie("profit-threshold",""),0<$("#region-roi-threshold").val().length&&!isNaN($("#region-roi-threshold").val())?setCookie("roi-threshold",threshold_roi=parseFloat($("#region-roi-threshold").val()),7):setCookie("roi-threshold",""),0<$("#region-buy-threshold").val().length&&!isNaN($("#region-buy-threshold").val())?setCookie("buy-threshold",threshold_cost=parseFloat($("#region-buy-threshold").val()),7):setCookie("buy-threshold",""),0<$("#region-weight-threshold").val().length&&!isNaN($("#region-weight-threshold").val())?setCookie("weight-threshold",threshold_weight=parseFloat($("#region-weight-threshold").val()),7):setCookie("weight-threshold",""))}function setupTradeOptions(t){tradingStyle=t,$(".howto").toggle(!1),$("#initial_choice").hide(),setAbout();var e="";1==tradingStyle?($("#route_trade").slideToggle(),e="Hauler - Station"):0==tradingStyle?($("#station_trade").slideToggle(),e="Station Trader"):2==tradingStyle&&($("#region_trade").slideToggle(),e="Hauler - Region"),gtag("event","User Preference Campaign",{event_category:"Trade Style",event_label:e,value:1})}function open_popup(t,e,o,n){!n.name&&citadelCache[n.station]&&(citadelCache[n.station]&&citadelCache[n.station].name?n.name=citadelCache[n.station].name+"*":n.name=citadelCache[n.station]+"*"),popup_table_buy.clear(),popup_table_sell.clear();var i=getStationName(n)||n.name,a=n.station||n;$("#popup_itemName").text("Trade info for "+e),$("#buyLocation").text("Buy at "+o.name),$("#sellLocation").text("Sell at "+i);for(var s=customBuy[o.station][t],r=customSell[a][t],l=0;l<s.length;l++)s[l]&&$("#popup-table-buy").dataTable().fnAddData([numberWithCommas(s[l][0].toFixed(2)),numberWithCommas(s[l][1].toFixed())]);for(l=0;l<r.length;l++)r[l]&&$("#popup-table-sell").dataTable().fnAddData([numberWithCommas(r[l][0].toFixed(2)),numberWithCommas(r[l][1].toFixed())]);$("#popup").modal("show"),popup_table_buy.draw(),popup_table_sell.draw()}function setCookie(t,e,o){var n=new Date;n.setTime(n.getTime()+24*o*60*60*1e3);var i="expires="+n.toUTCString();document.cookie=t+"="+e+";"+i+";path=/"}function getCookie(t){for(var e=t+"=",o=decodeURIComponent(document.cookie).split(";"),n=0;n<o.length;n++){for(var i=o[n];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""}function addStart(t){if(0==tradingStyle)$("#custom_station input")[0].value=t;else if(1==tradingStyle)if($("#start_station input")[0].value=t,shifted){var e={shiftKey:!0};newStartStation(e)}else newStartStation();else 2==tradingStyle&&($("#start_region input")[0].value=t)}function addEnd(t){if(0!=tradingStyle)if(1==tradingStyle)if($("#end_station input")[0].value=t,shifted){var e={shiftKey:!0};newEndStation(e)}else newEndStation();else 2==tradingStyle&&($("#end_region input")[0].value=t)}function setStationTradingLocations(){var t=$("#custom_station input")[0].value||$("#custom_station input")[1].value;startLocations=t.toLowerCase();var e=universeList[startLocations].region,o=universeList[startLocations].station;startLocations=universeList[startLocations].name,startCoordinates.region=e,startCoordinates.station=o}function setRouteRegionTradingLocations(){var t=$("#start_region input")[0].value||$("#start_region input")[1].value;startLocations=t.toLowerCase(),startCoordinates=universeList[startLocations],startLocations=startCoordinates.name,t=$("#end_region input")[0].value||$("#end_region input")[1].value,endLocations=t.toLowerCase(),endCoordinates=universeList[endLocations],endLocations=endCoordinates.name}function getCoordinatesFor(t,e){var n,i=[],a=[];if($.each($(t+" > li"),function(){var t={},e=$(this).text(),o=e.substring(0,e.length-2).toLowerCase();n=universeList[o],t.region=n.region,t.station=n.station,t.name=n.name,-1==a.indexOf(t.station)&&(i.push(t),a.push(t.station))}),$(e+" input")[0].value){var o=$(e+" input")[0].value||$(e+" input")[1].value;if(n=universeList[o.toLowerCase()]){var s={};s.region=n.region,s.station=n.station,s.name=n.name,-1==a.indexOf(s.station)&&i.push(s)}}return i}function setRouteStationTradingLocations(){if(0<(startCoordinates=getCoordinatesFor("#custom_route_start","#start_station")).length){startLocations=[];for(var t=0;t<startCoordinates.length;t++)startLocations.push(startCoordinates[t].name);for(endCoordinates=getCoordinatesFor("#custom_route_end","#end_station"),t=0;t<endCoordinates.length;t++)endLocations.push(endCoordinates[t].name)}}function execute(){if(1==tradingStyle){routes=[];for(var t=0;t<startCoordinates.length;t++)new Route(startCoordinates[t],endCoordinates).startRoute()}else 0==tradingStyle?new Station(startCoordinates).startStation():2==tradingStyle&&new Region(startCoordinates,endCoordinates).startRoute()}function init(){$(".tableLoadingIcon").show(),updateCookies(),1==tradingStyle?setRouteStationTradingLocations():0==tradingStyle?setStationTradingLocations():setRouteRegionTradingLocations();var t=startLocations&&0<startLocations.length,e=1<=tradingStyle&&0<endLocations.length||0==tradingStyle;t&&e?($(".error").hide(),$("#selection").hide(),createTradeHeader(),execute()):$(".error").show()}function displayError(){errorShown||($("#connectEVE").slideToggle(!0),errorShown=!0)}function hideError(){errorShown&&($("#connectEVE").slideToggle(),errorShown=!1)}var popup_table_buy,popup_table_sell,threshold_margin_lower=20,threshold_margin_upper=40,volume_threshold=1e3,threshold_profit=5e5,threshold_roi=4,threshold_cost=1e18,threshold_weight=1e18,tradingStyle=null,errorShown=!1,addedToStartList=[],addedToEndList=[],stationsReady=!1,regionsReady=!1,universeList={},stationIdToName={},startCoordinates=[],endCoordinates=[],startLocations=[],endLocations=[],shifted=!1;$(document).ready(function(){popup_table_buy=$("#popup-table-buy").DataTable({order:[[0,"asc"]],lengthMenu:[[10],["10"]]}),popup_table_sell=$("#popup-table-sell").DataTable({order:[[0,"desc"]],lengthMenu:[[10],["10"]]}),onClickListeners(),$('input[type="number"]').keypress(function(t){var e=t||window.event,o=e.keyCode||e.which;o=String.fromCharCode(o),/[0-9]|\./.test(o)||8===e.charCode||0===e.charCode||(e.returnValue=!1,e.preventDefault&&e.preventDefault())}),$(document).on("keyup keydown",function(t){return t.shiftKey?($(".add-station-button").val("Add System"),shifted=!0):($(".add-station-button").val("+"),shifted=!1),!0}),setAbout(),setupCookies(),setupCustomDropdown(),$(".show-amazon-offers").on("click",function(){$(".amazon-offers").slideToggle()}),$.fn.isInViewport=function(){var t=$(this).offset().top,e=t+$(this).outerHeight(),o=$(window).scrollTop(),n=o+$(window).height();return o<e&&t<n},$(window).on("resize scroll",function(){$(".branding").isInViewport()?$(".promo-item").css("transform","translateY(0)"):$(".promo-item").css("transform","translateY(-5em)")}),gtag("event","Browser Location Tracking",{event_category:"URI",event_label:window.location.href,value:1})}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.indexOf(t,e)===e});