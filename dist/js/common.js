function getMarketData(e,t,a,r,o){var s;"string"==typeof e?s=[e]:null!=e&&(s=getBestMarketPrice(e,t,a,r,o));var n=[];if(s)for(var i=0;i<s.length;i++)0<s[i][0]&&n.push(s[i]);return n}function getBestMarketPrice(e,t,a,r,o){for(var s=[],n=0;n<e.length;n++){var i=e[n],l=i.is_buy_order&&a===BUY_ORDER||!i.is_buy_order&&a===SELL_ORDER;if(t==i.location_id&&1===i.min_volume&&l){var d=i.price,u=i.volume_remain;s.push([d,u])}}if(a==SELL_ORDER){var c=o?sellOrderComparator:buyOrderComparator;s=s.sort(c),saveSellOrderData(t,r,$.extend(!0,[],s))}else{c=o?buyOrderComparator:sellOrderComparator;s=s.sort(c),saveBuyOrderData(t,r,$.extend(!0,[],s))}return s}function saveSellOrderData(e,t,a){a&&0<a.length&&(customBuy[e]||(customBuy[e]=[]),!customBuy[e][t]&&0<a.length&&(customBuy[e][t]=a))}function saveBuyOrderData(e,t,a){a&&0<a.length&&(customSell[e]||(customSell[e]=[]),!customSell[e][t]&&0<a.length&&(customSell[e][t]=a))}function sellOrderComparator(e,t){return e[0]>t[0]?-1:e[0]<t[0]?1:0}function buyOrderComparator(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0}function bestRowComparator(e,t){return e[5]<t[5]?1:e[5]>t[5]?-1:0}function getStationName(e){var t="";return $.each(endCoordinates,function(){0==t.length&&this.station==e&&(t=this.name)}),t}function numberWithCommas(e){for(;/(\d+)(\d{3})/.test(e.toString());)e=e.toString().replace(/(\d+)(\d{3})/,"$1,$2");return e}function incrementProgress(e,t){getTotalProgress(),e.completePages[t]=!0}function getTotalProgress(){for(var e=0,t=!0,a=0;a<routes.length;a++){t=t&&routes[a].completed,e+=routes[a].recalculateProgress()/routes.length}totalProgress=t?100:100<e?100:e,$(".loading").html("Fetching orders: "+(totalProgress-.01).toFixed(2)+"% complete"),$(".loadingContent").text((totalProgress-.01).toFixed(2)+"%")}function refresh(){$("#refresh-button").remove(),iteration+=1;for(var e=0;e<routes.length;e++)routes[e].clear();customBuy=[],customSell=[],startCoordinates=[],endCoordinates=[],startLocation="",addedToStartList=[],addedToEndList=[],endLocations=[],totalProgress=0,tableCreated=createdRefresher=!(page=1),routes=[],init()}function isSpamItem(e){for(var t=0;t<spamItems.length;t++)if(0<=e.toLowerCase().indexOf(spamItems[t]))return!0;return!1}function marketEndpointBuilder(e,t,a){return(ESI_ENDPOINT+"/latest/markets/"+e+"/orders/?datasource=tranquility&page="+t+"&order_type="+a+"&language=en-us&iteration="+iteration).replace(/\s/g,"")}function getWeightEndpointBuilder(e){return(ESI_ENDPOINT+"/latest/universe/types/"+e+"/?datasource=tranquility&language=en-us&iteration="+iteration).replace(/\s/g,"")}function getVolumeEndpointBuilder(e,t){return(ESI_ENDPOINT+"/latest/markets/"+e+"/history/?datasource=tranquility&type_id="+t+"&language=en-us&iteration="+iteration).replace(/\s/g,"")}function createTradeHeader(){var e="",t="",a="",r=$("#buyingHeader"),o=$("#buyingFooter"),s=$("#core");if(tradingStyle==STATION_HAUL?($.each(startLocations,function(){this&&(t+=this+", ")}),t=t.substring(0,t.length-2),$.each(endLocations,function(){this&&(a+=this+", ")}),a=a.substring(0,a.length-2)):tradingStyle==REGION_HAUL&&(t=startLocations,a=endLocations),tradingStyle==STATION_HAUL||tradingStyle==REGION_HAUL){r.text("Buying Sell Orders from "+t);var n="<div id='route-to'>Selling to the Buy Orders at "+a+"</div> ROI&nbsp;Greater&nbsp;Than&nbsp;"+threshold_roi+"% |&nbsp;Profits&nbsp;Greater&nbsp;Than&nbsp;"+numberWithCommas(threshold_profit)+"&nbsp;ISK";tradingStyle==REGION_HAUL&&(n+="<span id='citadelsLine'><br>* Indicates that the station is a citadel (confirm access at your own risk).</span>",n+="<br>Only showing system security status of "+$("#security-threshold").val()+" SEC or better."),1e18!==threshold_cost&&(n+=" |&nbsp;Buy&nbsp;Costs&nbsp;Less&nbsp;Than&nbsp;"+numberWithCommas(threshold_cost)+"&nbsp;ISK"),1e18!==threshold_weight&&(n+=" |&nbsp;Total&nbsp;Volume&nbsp;Under&nbsp;"+numberWithCommas(threshold_weight)+"&nbsp;m3"),r.show(),e=n+"<br/><div class='loading'></div>",o.html(e),o.show(),gtag("event","User Route Campaign",{event_category:"Route Trade Locations",event_label:t+" -> "+a,value:1})}else tradingStyle==STATION_TRADE&&(r.text("Station Trading at "+startLocations),r.show(),e="Volume greater than: "+numberWithCommas(volume_threshold)+" | Margins between "+threshold_margin_lower+"% and "+threshold_margin_upper+"%<div class='loading'>Loading. Please wait...</div>",o.html(e),o.show(),gtag("event","User Route Campaign",{event_category:"Station Trade Locations",event_label:startLocations,value:1}));s.show()}function createDataTable(){if(!tableCreated){tableCreated=!0,$("#noselect-object").html('<table id="dataTable" class="display"></table>'),$(".dataTableFilters").html("");var e=$("#dataTable");e.html("");for(var s,t="<thead>",a=tradingStyle===STATION_TRADE?stationHeader:tradingStyle===STATION_HAUL?routeHeader:regionHeader,r=0;r<a.length;r++)t+="<th>"+a[r]+"</th>";t+="</thead><tbody id='tableBody'></tbody>",e.append(t),tradingStyle==STATION_HAUL?s=e.DataTable({order:[[8,"desc"]],lengthMenu:[[100],["100"]],responsive:!0,dom:"Bfrtip",buttons:["copy","csv","excel","pdf"],columnDefs:[{targets:0,orderable:!1}]}):tradingStyle==REGION_HAUL?s=e.DataTable({order:[[9,"desc"]],lengthMenu:[[100],["100"]],responsive:!0,dom:"Bfrtip",buttons:["copy","csv","excel","pdf"],columnDefs:[{targets:0,orderable:!1}]}):tradingStyle==STATION_TRADE&&(s=e.DataTable({order:[[6,"desc"]],lengthMenu:[[100],["100"]],responsive:!0,dom:"Bfrtip",buttons:["copy","csv","excel","pdf"]})),$("#dataTable thead th").each(function(e){if(0<e||tradingStyle==STATION_TRADE){var t=s.column(e).header(),a=document.createElement("button"),r=[];a.innerHTML=t.innerHTML,$(a).addClass("colvistoggle"),$(a).addClass("btn"),$(a).addClass("btn-default"),$(a).attr("colidx",e),$(a).addClass("is-true"),s.column($(a).attr("colidx")).visible(!0);for(e=0;e<r.length;e++)if(a.innerHTML===r[e]){$(a).addClass("is-false"),s.column($(a).attr("colidx")).visible(!1);break}$(a).on("click",function(e){e.preventDefault();var t=s.column($(this).attr("colidx"));$(this).removeClass("is-"+t.visible()),t.visible(!t.visible()),$(this).addClass("is-"+t.visible())});var o=document.createElement("li");$(o).append($(a)),$("#colvis").append($(o))}}),$(".dropdown").on("show.bs.dropdown",function(){$(this).find(".dropdown-menu").first().stop(!0,!0).slideDown()}),$(".dropdown").on("hide.bs.dropdown",function(){$(this).find(".dropdown-menu").first().stop(!0,!0).slideUp()}),$("#dataTable tbody").on("mousedown","tr",function(e){var t=0<=e.target.id.indexOf("investigate")||e.target.children[0]&&0<=e.target.children[0].id.indexOf("investigate")||e.target.classList.contains("fa");1!==e.which||t||($(this).hasClass("row-selected")?$(this).removeClass("row-selected"):$(this).addClass("row-selected"))}),$("label > input").addClass("form-control").addClass("minor-text"),$("label > input").attr("placeholder","Filter by Station/Name..."),$(".dataTableFilters").append($("#dataTable_filter")),$(".dataTableFilters").append($(".dt-buttons")),$(".dt-button").addClass("btn"),$(".dt-button").addClass("btn-default"),$(".deal_note").hide(),$("#show-hide").show(),$("#dataTable").show(),$(".dataTables_paginate").on("click",function(){$(this)[0].scrollIntoView()})}}var BUY_ORDER="buy",SELL_ORDER="sell",ALL_ORDER="all",ESI_ENDPOINT="https://esi.evetech.net",STATION_TRADE=0,STATION_HAUL=1,REGION_HAUL=2,PAGE_MULTIPLE=50,tableCreated=!1,createdRefresher=!1,totalProgress=0,executingCount=0,customBuy={},customSell={},itemCache={},citadelCache={},systemSecurity={},routeCache={},page=1,iteration=1,rowAdded=!1,regionHeader=["","Buy Item","From","Quantity","At Sell Price","Total Cost","Take To","At Buy Price","Jumps","Profit per Jump","Total Profit","R.O.I","Total Volume (m3)"],routeHeader=["","Buy Item","From","Quantity","At Sell Price","Total Cost","Take To","At Buy Price","Total Profit","Profit Per Item","R.O.I","Total Volume (m3)"],stationHeader=["Item","Buy Order","Sell Order","Profit Per Item","Margin","24-Hour Volume","14-Day Volume","30-Day Volume"],spamItems=["ahremen's","brokara's","brynn's","chelm's","cormack's","draclira's","estamel's","gotan's","hakim's","kaikka's","mizuro's","raysere's","selynne's","setele's","shaqil's","tairei's","thon's","tuvan's","vizen's","zor's"];